st_coverage %>%
# filter(!is.na(ST) ) %>%
ungroup() %>%
ggplot(data = ., aes(x = YEAR, y = pct, color = Drug)) +
# geom_point() +
geom_point() +
geom_line(color  = "black") +
scale_x_continuous(breaks = c(2018,2020)) +
scale_y_continuous(labels = function(x) paste0(x*100,"%"), breaks = c(0, .5, 1)) +
theme(
text = element_text(family = "Avenir Next", color = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank(),
plot.title = element_text(size = 24, face = "bold"),
plot.subtitle = element_text(size = 18),
strip.background = element_rect(fill = "white", color = "black", size = .2),
strip.text = element_text(face = "bold"),
panel.background = element_rect(fill = "white", color = "white"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "black", size = .1)
) +
#  geom_rect(mapping=aes(xmin=2009, xmax=2012, ymin=0, ymax=100), fill = "#ADD8E6", alpha = .05) +
labs(
title = "Coverage of Triumeq and Biktarvy by Year",
#    subtitle = "Percent ADAP Budget Contributed by Federal Sources, 2007 - 2018",
x = element_blank(),
y = element_blank()
) +
facet_geo(~ ST, grid = "us_state_grid1")
st_coverage %>%
# filter(!is.na(ST) ) %>%
ungroup() %>%
ggplot(data = ., aes(x = YEAR, y = pct, color = Drug)) +
# geom_point() +
geom_point() +
geom_line() +
scale_x_continuous(breaks = c(2018,2020)) +
scale_y_continuous(labels = function(x) paste0(x*100,"%"), breaks = c(0, .5, 1)) +
theme(
text = element_text(family = "Avenir Next", color = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank(),
plot.title = element_text(size = 24, face = "bold"),
plot.subtitle = element_text(size = 18),
strip.background = element_rect(fill = "white", color = "black", size = .2),
strip.text = element_text(face = "bold"),
panel.background = element_rect(fill = "white", color = "white"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "black", size = .1)
) +
#  geom_rect(mapping=aes(xmin=2009, xmax=2012, ymin=0, ymax=100), fill = "#ADD8E6", alpha = .05) +
labs(
title = "Coverage of Triumeq and Biktarvy by Year",
#    subtitle = "Percent ADAP Budget Contributed by Federal Sources, 2007 - 2018",
x = element_blank(),
y = element_blank()
) +
facet_geo(~ ST, grid = "us_state_grid1")
st_coverage %>%
# filter(!is.na(ST) ) %>%
ungroup() %>%
ggplot(data = ., aes(x = YEAR, y = pct, color = Drug)) +
# geom_point() +
geom_point() +
geom_line() +
scale_x_continuous(breaks = c(2018,2020)) +
scale_y_continuous(labels = function(x) paste0(x*100,"%"), breaks = c(0, .5, 1)) +
theme(
text = element_text(family = "Avenir Next", color = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank(),
plot.title = element_text(size = 24, face = "bold"),
plot.subtitle = element_text(size = 18),
strip.background = element_rect(fill = "white", color = "black", size = .2),
strip.text = element_text(face = "bold"),
panel.background = element_rect(fill = "white", color = "white"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "black", size = .1)
) +
#  geom_rect(mapping=aes(xmin=2009, xmax=2012, ymin=0, ymax=100), fill = "#ADD8E6", alpha = .05) +
labs(
title = "Coverage of Triumeq and Biktarvy by Year",
#    subtitle = "Percent ADAP Budget Contributed by Federal Sources, 2007 - 2018",
x = element_blank(),
y = element_blank()
) +
facet_geo(~ ST, grid = "us_state_grid1")
st_coverage %>%
# filter(!is.na(ST) ) %>%
ungroup() %>%
ggplot(data = ., aes(x = YEAR, y = pct, color = Drug)) +
# geom_point() +
geom_point() +
geom_line() +
scale_x_continuous(breaks = c(2018,2020)) +
scale_y_continuous(labels = function(x) paste0(x*100,"%"), breaks = c(0, .5, 1)) +
theme(
text = element_text(family = "Avenir Next", color = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank(),
plot.title = element_text(size = 24, face = "bold"),
plot.subtitle = element_text(size = 18),
strip.background = element_rect(fill = "white", color = "black", size = .2),
strip.text = element_text(face = "bold"),
panel.background = element_rect(fill = "white", color = "white"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "black", size = .1)
) +
#  geom_rect(mapping=aes(xmin=2009, xmax=2012, ymin=0, ymax=100), fill = "#ADD8E6", alpha = .05) +
labs(
title = "Coverage of Triumeq and Biktarvy by Year",
#    subtitle = "Percent ADAP Budget Contributed by Federal Sources, 2007 - 2018",
x = element_blank(),
y = element_blank()
) +
facet_geo(~ ST, grid = "us_state_grid1")
st_coverage %>%
# filter(!is.na(ST) ) %>%
ungroup() %>%
ggplot(data = ., aes(x = YEAR, y = pct, color = Drug)) +
# geom_point() +
geom_point() +
geom_line() +
scale_x_continuous(breaks = c(2018,2020)) +
scale_y_continuous(labels = function(x) paste0(x*100,"%"), breaks = c(0, .5, 1)) +
theme(
text = element_text(family = "Avenir Next", color = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank(),
plot.title = element_text(size = 24, face = "bold"),
plot.subtitle = element_text(size = 18),
strip.background = element_rect(fill = "white", color = "black", size = .2),
strip.text = element_text(face = "bold"),
panel.background = element_rect(fill = "white", color = "white"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "black", size = .1)
) +
#  geom_rect(mapping=aes(xmin=2009, xmax=2012, ymin=0, ymax=100), fill = "#ADD8E6", alpha = .05) +
labs(
title = "Coverage of Triumeq and Biktarvy by Year",
#    subtitle = "Percent ADAP Budget Contributed by Federal Sources, 2007 - 2018",
x = element_blank(),
y = element_blank()
) +
facet_geo(~ ST, grid = "us_state_grid1")
st_coverage %>%
# filter(!is.na(ST) ) %>%
ungroup() %>%
ggplot(data = ., aes(x = YEAR, y = pct, color = Drug)) +
# geom_point() +
geom_point() +
geom_line() +
scale_x_continuous(breaks = c(2018,2020)) +
scale_y_continuous(labels = function(x) paste0(x*100,"%"), breaks = c(0, .5, 1), limits = c(0, 105)) +
theme(
text = element_text(family = "Avenir Next", color = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank(),
plot.title = element_text(size = 24, face = "bold"),
plot.subtitle = element_text(size = 18),
strip.background = element_rect(fill = "white", color = "black", size = .2),
strip.text = element_text(face = "bold"),
panel.background = element_rect(fill = "white", color = "white"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "black", size = .1)
) +
#  geom_rect(mapping=aes(xmin=2009, xmax=2012, ymin=0, ymax=100), fill = "#ADD8E6", alpha = .05) +
labs(
title = "Coverage of Triumeq and Biktarvy by Year",
#    subtitle = "Percent ADAP Budget Contributed by Federal Sources, 2007 - 2018",
x = element_blank(),
y = element_blank()
) +
facet_geo(~ ST, grid = "us_state_grid1")
st_coverage %>%
# filter(!is.na(ST) ) %>%
ungroup() %>%
ggplot(data = ., aes(x = YEAR, y = pct, color = Drug)) +
# geom_point() +
geom_point() +
geom_line() +
scale_x_continuous(breaks = c(2018,2020)) +
scale_y_continuous(labels = function(x) paste0(x*100,"%"), breaks = c(0, .5, 1), limits = c(0, 1.05)) +
theme(
text = element_text(family = "Avenir Next", color = "black"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.line.y = element_blank(),
plot.title = element_text(size = 24, face = "bold"),
plot.subtitle = element_text(size = 18),
strip.background = element_rect(fill = "white", color = "black", size = .2),
strip.text = element_text(face = "bold"),
panel.background = element_rect(fill = "white", color = "white"),
panel.grid.minor = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color = "black", size = .1)
) +
#  geom_rect(mapping=aes(xmin=2009, xmax=2012, ymin=0, ymax=100), fill = "#ADD8E6", alpha = .05) +
labs(
title = "Coverage of Triumeq and Biktarvy by Year",
#    subtitle = "Percent ADAP Budget Contributed by Federal Sources, 2007 - 2018",
x = element_blank(),
y = element_blank()
) +
facet_geo(~ ST, grid = "us_state_grid1")
st_coverage %>%
arrange(YEAR, -pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (color = Drug)) +
facet_wrap(YEAR~Drug)
st_coverage %>%
arrange(YEAR, -pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
st_coverage %>%
arrange(YEAR, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (YEAR)) +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = YEAR)) +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = YEAR), position = "dodge") +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = YEAR), position = dodge) +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = YEAR), position = "dodge") +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = YEAR), position = "dodge_y") +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(x = ST, y = pct)) +
geom_col(aes (fill = YEAR), position = "dodge_y") +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(x = ST, y = pct)) +
geom_col(aes (fill = YEAR), position = "dodge") +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(x = ST, y = pct)) +
geom_bar(stat = "identity", aes (fill = YEAR), position = "dodge") +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_bar(stat = "identity", aes (fill = YEAR), position = "dodge") +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = as.factor(YEAR)), position = "dodge") +
facet_grid(~Drug)
st_coverage %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order)
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = ST, x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = reorder(ST, order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
# Coverage By State
``` {r, fig.width = 9, fig.height = 12 }
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
ggplot(aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
split( YEAR)
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
split( .$YEAR)
map(year_groups
~  ggplot(.x, aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(YEAR~Drug)
)
map(year_groups,
~  ggplot(.x, aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(~Drug)
)
year_groups<-
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
split( .$YEAR)
map(year_groups,
~  ggplot(.x, aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(~Drug)
)
year_groups<-
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
split( .$YEAR)
map(year_groups,
~  ggplot(.x, aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(~Drug)
)
year_groups<-
st_coverage %>%
mutate(
order =
case_when( Drug == "Biktarvy" ~ pct,
TRUE ~ 0),
) %>%
group_by(YEAR, ST) %>%
mutate(order = sum(order)) %>%
arrange(YEAR, order) %>%
ungroup() %>%
arrange(YEAR, Drug, pct) %>%
split( .$YEAR)
map(year_groups,
~  ggplot(.x, aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(~Drug)
)
map(year_groups,
~  ggplot(.x, aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(~Drug) +
labs(title = paste0(unique(.x$YEAR) ))
)
map(year_groups,
~  ggplot(.x, aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(~Drug) +
labs(title = paste0(unique(.x$YEAR), " Coverage" ), y = "ST", )
)
map(year_groups,
~  ggplot(.x, aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(~Drug) +
labs(title = paste0(unique(.x$YEAR), " Coverage" ), y = "ST", )
)
labs(title = paste0(unique(.x$YEAR), " Coverage" ), y = "ST")
labs(title = paste0(unique(.x$YEAR), " Coverage" ), y = "ST")
map(year_groups,
~  ggplot(.x, aes(y = reorder(ST, -order), x = pct)) +
geom_col(aes (fill = Drug)) +
facet_grid(~Drug) +
labs(title = paste0(unique(.x$YEAR), " Coverage" ),  y = "ST")
)
